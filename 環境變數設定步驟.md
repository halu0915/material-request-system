# 📝 Render 環境變數設定步驟（圖解版）

## 🎯 目標
在 Render Dashboard 中設定 7 個環境變數

---

## 📍 步驟 1: 進入環境變數設定頁面

1. 登入 Render Dashboard：https://dashboard.render.com
2. 找到您的 Web Service：**material-request-system**
3. 點選該服務
4. 在左側選單中點選 **「Environment」**

---

## 📋 步驟 2: 新增環境變數

在「Environment Variables」區塊中，點選 **「Add Environment Variable」** 按鈕

---

## ✅ 步驟 3: 逐一新增以下變數

### 變數 1: NODE_ENV
- **Key**: `NODE_ENV`
- **Value**: `production`
- 點選「Save」

### 變數 2: PORT
- **Key**: `PORT`
- **Value**: `5000`
- 點選「Save」

### 變數 3: DATABASE_URL
- **Key**: `DATABASE_URL`
- **Value**: 
  1. 前往您的 PostgreSQL 服務（material-request-db）
  2. 在「Connection」區塊找到「Internal Database URL」
  3. 複製該 URL
  4. 貼到此處
- ⚠️ **必須使用 Internal Database URL**
- 點選「Save」

### 變數 4: JWT_SECRET
- **Key**: `JWT_SECRET`
- **Value**: `OkcpmA5cA9AfyLiGbK0nIelObvmiRPopuKryFW2N/io=`
- 點選「Save」

### 變數 5: FRONTEND_URL
- **Key**: `FRONTEND_URL`
- **Value**: `https://material-request-system.onrender.com`
- ⚠️ 部署完成後請更新為實際的服務 URL
- 點選「Save」

### 變數 6: TRIAL_EMAIL（建議）
- **Key**: `TRIAL_EMAIL`
- **Value**: `trial@material-request.com`
- 點選「Save」

### 變數 7: TRIAL_PASSWORD（建議）
- **Key**: `TRIAL_PASSWORD`
- **Value**: `trial123456`
- 點選「Save」

---

## ✅ 步驟 4: 確認設定

檢查「Environment Variables」列表，確認所有變數都已正確新增：

```
✓ NODE_ENV = production
✓ PORT = 5000
✓ DATABASE_URL = postgresql://...
✓ JWT_SECRET = OkcpmA5cA9AfyLiGbK0nIelObvmiRPopuKryFW2N/io=
✓ FRONTEND_URL = https://material-request-system.onrender.com
✓ TRIAL_EMAIL = trial@material-request.com
✓ TRIAL_PASSWORD = trial123456
```

---

## 🚀 步驟 5: 自動部署

設定完成後，Render 會自動：
- 重新部署服務
- 套用新的環境變數
- 啟動服務

您可以在「Logs」頁籤查看部署進度。

---

## 📊 完整的環境變數列表（複製用）

```
NODE_ENV=production
PORT=5000
DATABASE_URL=<從PostgreSQL複製的Internal URL>
JWT_SECRET=OkcpmA5cA9AfyLiGbK0nIelObvmiRPopuKryFW2N/io=
FRONTEND_URL=https://material-request-system.onrender.com
TRIAL_EMAIL=trial@material-request.com
TRIAL_PASSWORD=trial123456
```

---

## 🔍 如何找到 DATABASE_URL

### 方法：
1. 在 Render Dashboard 左側選單找到「PostgreSQL」服務
2. 點選 **material-request-db**
3. 進入服務設定頁面
4. 找到「Connection」區塊
5. 複製「**Internal Database URL**」

### 格式範例：
```
postgresql://user:password@dpg-xxxxx-a.singapore-postgres.render.com/dbname
```

⚠️ **重要**：
- 必須使用 **Internal Database URL**
- 不要使用 External Database URL
- Internal URL 格式通常包含 `-a.` 或 `-b.` 等

---

## ✅ 設定完成檢查清單

完成設定後，請確認：

- [ ] 所有 7 個環境變數都已新增
- [ ] DATABASE_URL 使用的是 Internal URL
- [ ] JWT_SECRET 已正確設定
- [ ] 服務已開始重新部署

---

## 🆘 遇到問題？

### 問題 1: 找不到 Internal Database URL
**解決方法**：
- 確認 PostgreSQL 服務已建立完成
- 檢查是否在同一區域（Region）
- 如果只有 External URL，檢查資料庫狀態

### 問題 2: 設定後服務沒有重新部署
**解決方法**：
- 手動觸發部署：在「Events」頁籤點選「Manual Deploy」
- 檢查 Auto-Deploy 是否已開啟

### 問題 3: 不知道服務 URL
**解決方法**：
- 部署完成後，Render 會在服務頁面顯示 URL
- 格式可能是：`https://material-request-system-xxxx.onrender.com`
- 記得更新 `FRONTEND_URL` 環境變數

---

## 📞 需要協助？

如果遇到問題：
1. 查看「Logs」頁籤的錯誤訊息
2. 確認所有環境變數都已正確設定
3. 參考詳細指南：`環境變數設定指南.md`

