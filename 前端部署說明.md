# 🚀 前端部署說明

## 📋 部署狀態

前端已配置為與後端一起部署在同一個服務上。

## ✅ 已完成的配置

### 1. API 配置 (`client/src/utils/api.ts`)
- ✅ 生產環境使用相對路徑（與後端同一個服務）
- ✅ 開發環境使用 `http://localhost:5000`
- ✅ 可通過環境變數 `VITE_API_URL` 自定義

### 2. 構建配置
- ✅ `render.yaml` 已更新，包含前端構建
- ✅ 構建命令：`npm install:all && npm run build`
- ✅ 同時構建後端和前端

### 3. 靜態文件服務 (`server/src/index.ts`)
- ✅ 後端自動檢測並服務前端構建文件
- ✅ 如果前端未構建，顯示 API 資訊

## 🔧 構建流程

1. **安裝依賴**
   ```bash
   npm install:all
   ```
   這會安裝根目錄、server 和 client 的所有依賴

2. **構建**
   ```bash
   npm run build
   ```
   這會：
   - 構建後端（TypeScript → JavaScript）
   - 構建前端（React + Vite → 靜態文件）

3. **啟動服務**
   ```bash
   cd server && npm start
   ```
   服務會：
   - 啟動 Express 服務器
   - 自動服務前端靜態文件（如果存在）

## 📁 文件結構

```
叫料系統/
├── client/
│   ├── dist/              # 前端構建輸出（部署時生成）
│   ├── src/
│   └── package.json
├── server/
│   ├── dist/              # 後端構建輸出
│   ├── src/
│   └── package.json
└── package.json           # 根 package.json
```

## 🌐 生產環境配置

### API URL
前端在生產環境會自動使用相對路徑（`''`），因為前端和後端在同一個服務上。

### 環境變數
如需自定義 API URL，可在 Render 設定環境變數：
- `VITE_API_URL`: 前端 API URL（可選）

**注意**：由於 Vite 的環境變數在構建時注入，如果使用 `VITE_API_URL`，需要在構建前設定。

## ✅ 部署檢查清單

- [x] 前端構建配置完成
- [x] API 配置正確
- [x] 靜態文件服務配置完成
- [x] Render 構建命令更新
- [ ] 前端構建成功（待部署確認）
- [ ] 前端頁面可正常訪問（待部署確認）

## 🧪 測試

部署後，訪問服務 URL：
```
https://material-request-system-uadw.onrender.com
```

應該看到：
- ✅ 前端登入頁面（如果前端構建成功）
- ✅ 或 API 資訊頁面（如果前端未構建）

## 🔍 故障排除

### 前端未顯示

1. **檢查構建日誌**
   - 查看 Render 構建日誌
   - 確認 `npm run build:client` 成功執行

2. **檢查文件路徑**
   - 確認 `client/dist/index.html` 存在
   - 確認 `server/src/index.ts` 中的路徑正確

3. **檢查構建命令**
   - 確認 `render.yaml` 中的 `buildCommand` 正確

### API 請求失敗

1. **檢查 API 配置**
   - 確認 `client/src/utils/api.ts` 中的 `getBaseURL()` 正確

2. **檢查 CORS 設定**
   - 確認後端 CORS 設定允許前端域名

## 📝 注意事項

1. **環境變數**：Vite 的環境變數（`VITE_*`）在構建時注入，不是運行時
2. **構建順序**：先構建後端，再構建前端
3. **靜態文件**：前端構建後，文件在 `client/dist/` 目錄

## 🎉 完成

前端已配置完成，等待部署確認！

